###
# Munyire API Test File
#
# This file can be used with the "REST Client" extension in Visual Studio Code.
# It allows you to send HTTP requests directly from your editor.
#
# How to use:
# 1. Install "REST Client" extension in VS Code
# 2. Make sure your backend server is running (`npm start` or `npm run dev`)
# 3. First, run the "Register Admin" request to create an admin user
# 4. Then run "Login as Admin" to get auth token
# 5. The token will be automatically saved to @adminToken variable
# 6. Now you can run any of the other requests to test the API
###

@baseUrl = http://localhost:3001/api

# Variables for tokens (will be set after login)
@adminToken = 
@managerToken = 

###
# 1. AUTHENTICATION (/api/auth)
###

### Register Admin User
# @name registerAdmin
POST {{baseUrl}}/auth/register
Content-Type: application/json

{
    "DNev": "Admin User",
    "Email": "admin@test.com",
    "Telefonszam": "123456789",
    "Nem": "Férfi",
    "Munkakor": "Admin",
    "Szerepkor": "Admin",
    "FelhasznaloNev": "adminuser",
    "Jelszo": "password123"
}

###

### Register Manager User
# @name registerManager
POST {{baseUrl}}/auth/register
Content-Type: application/json
x-auth-token: {{adminToken}}

{
    "DNev": "Manager User",
    "Email": "manager@test.com",
    "Telefonszam": "987654321",
    "Nem": "Nő",
    "Munkakor": "Manager",
    "Szerepkor": "Manager",
    "FelhasznaloNev": "manageruser",
    "Jelszo": "password123"
}

###

### Login as Admin
# @name loginAdmin
POST {{baseUrl}}/auth/login
Content-Type: application/json

{
    "FelhasznaloNev": "adminuser",
    "Jelszo": "password123"
}

###

### Login as Manager
# @name loginManager
POST {{baseUrl}}/auth/login
Content-Type: application/json

{
    "FelhasznaloNev": "manageruser",
    "Jelszo": "password123"
}

###

###
# 2. DOLGOZOK (/api/dolgozok)
###

### Get all employees (Manager, Admin)
GET {{baseUrl}}/dolgozok
x-auth-token: {{adminToken}}

###

### Get employee by ID (Dolgozo saját, Manager, Admin)
GET {{baseUrl}}/dolgozok/1
x-auth-token: {{adminToken}}

###

### Update employee (Admin only)
PATCH {{baseUrl}}/dolgozok/1
Content-Type: application/json
x-auth-token: {{adminToken}}

{
    "Email": "updated@test.com",
    "Telefonszam": "999999999",
    "Szerepkor": "Manager"
}

###

### Delete employee (Admin only)
DELETE {{baseUrl}}/dolgozok/1
x-auth-token: {{adminToken}}

###

### Get employees with active items (Manager, Admin)
GET {{baseUrl}}/dolgozok/with-active-items
x-auth-token: {{adminToken}}

###

### Get employee's all clothing issues
GET {{baseUrl}}/dolgozok/1/ruhak
x-auth-token: {{adminToken}}

###

### Get employee's active clothing items
GET {{baseUrl}}/dolgozok/1/ruhak/aktiv
x-auth-token: {{adminToken}}

###

###
# 3. RUHAK (/api/ruhak)
###

### Get all clothing items (Manager, Admin)
GET {{baseUrl}}/ruhak
x-auth-token: {{adminToken}}

###

### Search clothing items
GET {{baseUrl}}/ruhak/search?q=Póló
x-auth-token: {{adminToken}}

###

### Get clothing item by cikkszam
GET {{baseUrl}}/ruhak/by-cikkszam/TEST-001
x-auth-token: {{adminToken}}

###

### Get clothing item by ID
GET {{baseUrl}}/ruhak/1
x-auth-token: {{adminToken}}

###

### Create new clothing item (Admin only)
POST {{baseUrl}}/ruhak
Content-Type: application/json
x-auth-token: {{adminToken}}

{
    "Cikkszam": "TEST-001",
    "Fajta": "Póló",
    "Szin": "Kék",
    "Meret": "L",
    "Mennyiseg": 100,
    "Minoseg": "Uj"
}

###

### Update clothing item (Admin only)
PATCH {{baseUrl}}/ruhak/1
Content-Type: application/json
x-auth-token: {{adminToken}}

{
    "Mennyiseg": 150,
    "Minoseg": "Jo"
}

###

### Delete clothing item (Admin only)
DELETE {{baseUrl}}/ruhak/1
x-auth-token: {{adminToken}}

###

### Get clothing item history
GET {{baseUrl}}/ruhak/1/history
x-auth-token: {{adminToken}}

###

### Get active issues for clothing item
GET {{baseUrl}}/ruhak/1/active
x-auth-token: {{adminToken}}

###

###
# 4. RUHAKIBE (/api/ruhakibe)
###

### Get all transactions (Manager, Admin)
GET {{baseUrl}}/ruhakibe
x-auth-token: {{adminToken}}

###

### Get my transactions (Dolgozo, Manager, Admin)
GET {{baseUrl}}/ruhakibe/mine
x-auth-token: {{adminToken}}

###

### Get active transactions (Manager, Admin)
GET {{baseUrl}}/ruhakibe/active
x-auth-token: {{adminToken}}

###

### Get returned transactions (Manager, Admin)
GET {{baseUrl}}/ruhakibe/returned
x-auth-token: {{adminToken}}

###

### Get transactions by date range
GET {{baseUrl}}/ruhakibe/by-date?from=2026-01-01&to=2026-01-31
x-auth-token: {{adminToken}}

###

### Get transaction statistics
GET {{baseUrl}}/ruhakibe/stats
x-auth-token: {{adminToken}}

###

### Get transaction by ID (Manager, Admin)
GET {{baseUrl}}/ruhakibe/1
x-auth-token: {{adminToken}}

###

### Create new issue (kiadás) (Manager, Admin)
POST {{baseUrl}}/ruhakibe
Content-Type: application/json
x-auth-token: {{adminToken}}

{
    "DolgozoID": 1,
    "RuhaID": 1,
    "KiadasDatum": "2026-01-15T10:00:00Z",
    "Mennyiseg": 2,
    "Indok": "Új belépő felszerelés"
}

###

### Create return (visszavétel) (Manager, Admin)
PATCH {{baseUrl}}/ruhakibe/1
Content-Type: application/json
x-auth-token: {{adminToken}}

{
    "VisszaDatum": "2026-01-20T10:00:00Z",
    "RuhaMinoseg": "Jo"
}

###

### Delete transaction (Admin only)
DELETE {{baseUrl}}/ruhakibe/1
x-auth-token: {{adminToken}}

###

###
# 5. RENDELESEK (/api/rendelesek)
###

### Get all orders (Manager, Admin)
GET {{baseUrl}}/rendelesek
x-auth-token: {{adminToken}}

###

### Get pending orders (Manager, Admin)
GET {{baseUrl}}/rendelesek/pending
x-auth-token: {{adminToken}}

###

### Get orders by status (Manager, Admin)
GET {{baseUrl}}/rendelesek/by-status/Leadva
x-auth-token: {{adminToken}}

###

### Get orders by clothing item (Manager, Admin)
GET {{baseUrl}}/rendelesek/by-ruha/1
x-auth-token: {{adminToken}}

###

### Get order by ID (Manager, Admin)
GET {{baseUrl}}/rendelesek/1
x-auth-token: {{adminToken}}

###

### Create new order (Manager, Admin)
POST {{baseUrl}}/rendelesek
Content-Type: application/json
x-auth-token: {{adminToken}}

{
    "RuhaID": 1,
    "RDatum": "2026-01-15T11:00:00Z",
    "Mennyiseg": 25,
    "Statusz": "Leadva"
}

###

### Update order (Manager, Admin)
PATCH {{baseUrl}}/rendelesek/1
Content-Type: application/json
x-auth-token: {{adminToken}}

{
    "Statusz": "Teljesítve"
}

###

### Complete order (Admin only) - increases stock
PATCH {{baseUrl}}/rendelesek/1/complete
x-auth-token: {{adminToken}}

###

### Delete order (Admin only)
DELETE {{baseUrl}}/rendelesek/1
x-auth-token: {{adminToken}}

###

###
# 6. DASHBOARD (/api/dashboard)
###

### Get dashboard stats (Manager, Admin)
GET {{baseUrl}}/dashboard/stats
x-auth-token: {{adminToken}}

###

### Get low stock items (Manager, Admin)
GET {{baseUrl}}/dashboard/low-stock?threshold=10
x-auth-token: {{adminToken}}

###

### Get recent activity (Manager, Admin)
GET {{baseUrl}}/dashboard/recent-activity?limit=10
x-auth-token: {{adminToken}}

###

###
# 7. REPORTS (/api/reports)
###

### Get inventory report (Manager, Admin)
GET {{baseUrl}}/reports/inventory
x-auth-token: {{adminToken}}

###

### Get employee summary (Manager, Admin)
GET {{baseUrl}}/reports/employee-summary
x-auth-token: {{adminToken}}

###

### Get monthly report (Manager, Admin)
GET {{baseUrl}}/reports/monthly?year=2026&month=1
x-auth-token: {{adminToken}}

###

### Get quality summary (Admin only)
GET {{baseUrl}}/reports/quality-summary
x-auth-token: {{adminToken}}

###

###
# 8. HEALTH CHECK
###

### Health check
GET http://localhost:3001/health

